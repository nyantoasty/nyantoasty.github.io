<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pattern-to-JSON Generator Guide</title>
    <link rel="icon" type="image/png" href="/assets/icons/yarn-ball-icon.png">
    <!-- Chosen Palette: Warm Neutral -->
    <!-- Application Structure Plan: A vertical, single-page guide designed as an interactive "Prompt Builder". The user follows a step-by-step process to prepare their pattern and generate the full AI prompt. A separate reference section below uses tabs and interactive elements to explain the required JSON schema and show clear examples. This task-oriented flow (building the prompt) is prioritized over simply displaying the document, making the information more actionable and easier to understand for the user's goal of generating JSON. -->
    <!-- Visualization & Content Choices: Report Info: Whole document -> Goal: Guide user in creating an AI prompt -> Presentation: Interactive form/builder for prompt generation, and tabbed/collapsible sections for technical reference. -> Interaction: Text input, copy-to-clipboard button, content toggles. -> Justification: Transforms a static guide into a practical tool, directly assisting the user's workflow. The structure separates the "doing" part (building the prompt) from the "learning" part (reference), which is a better user experience. -> Library/Method: Vanilla JS for interactions, Tailwind CSS for layout. NO SVG/Mermaid used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fdfaf6;
            color: #4a4a4a;
        }
        .mono {
            font-family: 'Roboto Mono', monospace;
            background-color: #f0e9e1;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .code-block {
            background-color: #f7f2ec;
            border: 1px solid #e4dace;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            color: #5c5c5c;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: 1px solid transparent;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .tab-button.active {
            background-color: #ffffff;
            color: #9a3412;
            border-color: #e4dace;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .tab-button:not(.active):hover {
            background-color: #f7f2ec;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .json-key {
            color: #c2410c;
        }
        .json-string {
            color: #1e6043;
        }
        .json-number {
            color: #1d4ed8;
        }
        .json-boolean {
            color: #7c2d12;
        }
        .tooltip {
            visibility: hidden; opacity: 0;
            transition: opacity 0.2s;
            position: absolute; z-index: 10;
            bottom: 125%; left: 50%;
            transform: translateX(-50%);
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            background-color: #2a2a2a;
            color: #f0e9e1;
            font-size: 0.875rem;
            white-space: nowrap;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tooltip-trigger:hover .tooltip {
            visibility: visible; opacity: 1;
        }
        .tooltip::after {
            content: ""; position: absolute;
            top: 100%; left: 50%;
            margin-left: -5px; border-width: 5px;
            border-style: solid;
            border-color: #2a2a2a transparent transparent transparent;
        }
    </style>
</head>
<body class="antialiased">

    <div class="max-w-5xl mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-2">AI Pattern-to-JSON Generator Guide</h1>
            <p class="text-lg text-gray-600">An interactive tool to generate prompts for converting craft patterns into structured JSON.</p>
        </header>

        <main class="space-y-16">
            
            <section id="prompt-builder" class="bg-white p-6 sm:p-8 rounded-xl shadow-sm border border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-4">Prompt Builder</h2>

                <div class="space-y-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">Step 1: Choose Your Pattern Format</h3>
                        <div id="pattern-type-selector" class="flex items-center space-x-2 bg-stone-100 p-1 rounded-lg max-w-xs">
                            <button data-type="text" class="w-1/2 tab-button active">Text</button>
                            <button data-type="image" class="w-1/2 tab-button">Image</button>
                        </div>
                        <div id="image-instructions" class="hidden mt-4 p-4 bg-amber-50 border border-amber-200 rounded-lg text-amber-800">
                            <h4 class="font-semibold mb-2">Image-Based Pattern Workflow</h4>
                            <p class="text-sm">This is a two-step process:</p>
                            <ol class="list-decimal list-inside mt-2 space-y-1 text-sm">
                                <li><strong>Transcribe Image:</strong> Use an AI with vision capabilities. Give it your image and use the prompt: <span class="mono text-xs">"Please transcribe the text from this image of a pattern."</span></li>
                                <li><strong>Generate JSON:</strong> Copy the transcribed text from the AI and paste it into the text area in Step 2 below.</li>
                            </ol>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">Step 2: Paste Your Pattern Text</h3>
                        <p class="text-sm text-gray-500 mb-3">Paste the full, raw text of your pattern here. If you transcribed it from an image, paste that text.</p>
                        <textarea id="pattern-input" rows="10" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-300 focus:border-orange-400 transition" placeholder="Paste pattern text here..."></textarea>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">Step 3: Generate and Copy Your AI Prompt</h3>
                        <p class="text-sm text-gray-500 mb-3">The complete prompt has been generated below based on your input. Use the button to copy it and paste it into the AI of your choice.</p>
                        <div class="relative">
                            <button id="copy-prompt-button" class="absolute top-3 right-3 bg-white hover:bg-stone-100 text-gray-600 font-medium py-1 px-3 border border-gray-300 rounded-md text-sm transition-colors">
                                <span id="copy-default">Copy</span>
                                <span id="copy-success" class="hidden">Copied!</span>
                            </button>
                            <div id="prompt-output" class="code-block text-sm">Select a pattern type and paste text to generate the prompt.</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="reference" class="bg-white p-6 sm:p-8 rounded-xl shadow-sm border border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-4">Technical Reference</h2>

                <div class="space-y-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">JSON Structure Overview</h3>
                        <div class="code-block">
<pre>{
  <span class="json-key">"metadata"</span>: { ... }, <span class="text-gray-400">// Pattern info</span>
  <span class="json-key">"glossary"</span>: { ... }, <span class="text-gray-400">// Stitch definitions</span>
  <span class="json-key">"instructions"</span>: [ ... ] <span class="text-gray-400">// Array of step objects</span>
}</pre>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">The `instruction` Object Schema</h3>
                        <p class="text-sm text-gray-500 mb-3">Each object in the `instructions` array follows this schema. Hover over properties for details.</p>
                        <div class="code-block">
<pre>{
  <span class="relative tooltip-trigger"><span class="json-key">"step"</span><span class="tooltip">Use for a single, unique step.</span></span>: <span class="json-number">63</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"stepRange"</span><span class="tooltip">Use to group multiple identical steps.</span></span>: [<span class="json-number">4</span>, <span class="json-number">62</span>],
  <span class="relative tooltip-trigger"><span class="json-key">"stepType"</span><span class="tooltip">Optional: 'even' or 'odd' to filter steps within a range.</span></span>: <span class="json-string">"even"</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"type"</span><span class="tooltip">The type of step, e.g., 'Row' or 'Round'.</span></span>: <span class="json-string">"Row"</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"side"</span><span class="tooltip">Optional: 'RS', 'WS', or omit if not applicable.</span></span>: <span class="json-string">"RS"</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"increase"</span><span class="tooltip">Net change in stitch count for this step.</span></span>: <span class="json-number">2</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"totalStitches"</span><span class="tooltip">The final stitch count after this step is completed.</span></span>: <span class="json-number">139</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"dynamicChunks"</span><span class="tooltip">Set to true if parts of the row (e.g., 'k to marker') need to be calculated by the app.</span></span>: <span class="json-boolean">false</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"displayText"</span><span class="tooltip">The original, human-readable instruction text.</span></span>: <span class="json-string">"&lt;b&gt;Row 63...&lt;/b&gt;"</span>,
  <span class="relative tooltip-trigger"><span class="json-key">"chunks"</span><span class="tooltip">An array of logical sections of the pattern step.</span></span>: [ { ... } ]
}</pre>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Examples</h3>
                        <div class="flex items-center space-x-2 mb-4 p-1 bg-stone-100 rounded-lg max-w-md">
                            <button id="tab-ex1" class="tab-button w-1/2 active">Unique Row</button>
                            <button id="tab-ex2" class="tab-button w-1/2">Grouped Rows</button>
                        </div>

                        <div id="content-ex1" class="tab-content active space-y-3">
                            <p class="text-sm text-gray-600"><strong>Pattern says:</strong> Row 63 (RS): k3, kfb, (yo, ssk, k5, k2tog, yo, k1) 6 times, k3, m1L, k1, m1R, k3, ...</p>
                            <p class="text-sm text-gray-500">This becomes a single object with a fully defined `chunks` array.</p>
                            <div class="code-block">
<pre>{
  <span class="json-key">"step"</span>: <span class="json-number">63</span>, <span class="json-key">"type"</span>: <span class="json-string">"Row"</span>, <span class="json-key">"side"</span>: <span class="json-string">"RS"</span>, <span class="json-key">"increase"</span>: <span class="json-number">2</span>, <span class="json-key">"totalStitches"</span>: <span class="json-number">139</span>,
  <span class="json-key">"displayText"</span>: <span class="json-string">"<b>Row 63 (RS):</b> ..."</span>,
  <span class="json-key">"chunks"</span>: [
    { <span class="json-key">"name"</span>: <span class="json-string">"Edge & Inc"</span>, <span class="json-key">"pattern"</span>: [<span class="json-string">"k3"</span>, <span class="json-string">"kfb"</span>] },
    { <span class="json-key">"name"</span>: <span class="json-string">"Lace 1 Left"</span>, <span class="json-key">"repeats"</span>: <span class="json-number">6</span>, <span class="json-key">"pattern"</span>: [<span class="json-string">"yo"</span>, <span class="json-string">"ssk"</span>, <span class="json-string">"k5"</span>, ...] },
    { <span class="json-key">"name"</span>: <span class="json-string">"Center Panel"</span>, <span class="json-key">"pattern"</span>: [<span class="json-string">"k3"</span>, <span class="json-string">"m1L"</span>, <span class="json-string">"k1"</span>, ...] },
    { <span class="json-key">"name"</span>: <span class="json-string">"Lace 1 Right"</span>, <span class="json-key">"repeats"</span>: <span class="json-number">6</span>, <span class="json-key">"pattern"</span>: [<span class="json-string">"yo"</span>, <span class="json-string">"ssk"</span>, <span class="json-string">"k5"</span>, ...] },
    { <span class="json-key">"name"</span>: <span class="json-string">"Inc & Edge"</span>, <span class="json-key">"pattern"</span>: [<span class="json-string">"kfb"</span>, <span class="json-string">"k3"</span>] }
  ]
}</pre>
                            </div>
                        </div>

                        <div id="content-ex2" class="tab-content space-y-3">
                            <p class="text-sm text-gray-600"><strong>Pattern says:</strong> Rows 3-61 (Odd, RS): ...k to marker... and Rows 4-62 (Even, WS): ...purl to last 3...</p>
                            <p class="text-sm text-gray-500">These are grouped into two objects using `stepRange` and `stepType`. They use `dynamicChunks: true` because parts of the row change with each repeat.</p>
                            <div class="code-block">
<pre>[
  {
    <span class="json-key">"stepRange"</span>: [<span class="json-number">3</span>, <span class="json-number">61</span>], <span class="json-key">"stepType"</span>: <span class="json-string">"odd"</span>, <span class="json-key">"side"</span>: <span class="json-string">"RS"</span>, <span class="json-key">"increase"</span>: <span class="json-number">4</span>,
    <span class="json-key">"dynamicChunks"</span>: <span class="json-boolean">true</span>,
    <span class="json-key">"displayText"</span>: <span class="json-string">"<b>Odd Rows 3-61 (RS):</b> k3, kfb, k to marker..."</span>
  },
  {
    <span class="json-key">"stepRange"</span>: [<span class="json-number">4</span>, <span class="json-number">62</span>], <span class="json-key">"stepType"</span>: <span class="json-string">"even"</span>, <span class="json-key">"side"</span>: <span class="json-string">"WS"</span>, <span class="json-key">"increase"</span>: <span class="json-number">0</span>,
    <span class="json-key">"dynamicChunks"</span>: <span class="json-boolean">true</span>,
    <span class="json-key">"displayText"</span>: <span class="json-string">"<b>Even Rows 4-62 (WS):</b> k3, purl to last 3, k3."</span>
  }
]</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const patternTypeSelector = document.getElementById('pattern-type-selector');
    const imageInstructions = document.getElementById('image-instructions');
    const patternInput = document.getElementById('pattern-input');
    const promptOutput = document.getElementById('prompt-output');
    const copyButton = document.getElementById('copy-prompt-button');

    const basePrompt = `# AI Prompt: Convert a Craft Pattern to a Smartly Grouped JSON

## 1. The Goal & Persona

You are an expert technical editor for fiber arts (knitting, crochet, Tunisian crochet) and a software developer. Your task is to convert a human-readable pattern into a strict, **craft-agnostic**, and efficiently grouped JSON format for a web application. The primary goal is to provide enough data for a "Stitch Locator" feature. This means that while we will group identical rows to save space, the structure must allow the application to calculate the exact stitch sequence for any given row.

## 2. The Input Pattern

Paste the complete, raw text of the pattern here.

\`\`\`
{{PATTERN_TEXT}}
\`\`\`

## 3. The Required JSON Output Structure

You must generate a single JSON object. Note that some fields like \`side\` are **optional** to support various crafts.

\`\`\`json
{
  "metadata": {
    "name": "Pattern Name",
    "author": "Author Name",
    "maxSteps": 116 
  },
  "glossary": {
    "k": { "name": "Knit", "description": "..." },
    "sc": { "name": "Single Crochet", "description": "..." }
  },
  "instructions": []
}
\`\`\`

## 4. Detailed Instructions for Generating the \`instructions\` Array

You will create JSON objects representing either a single, unique step or a range of identical/systematic steps.

### Key Rules:

* **Smart Grouping:** If a sequence of steps (e.g., Rows 4, 6, 8...62) are functionally identical, group them using a \`stepRange: [start, end]\` and an optional \`stepType: "even"\` or \`"odd"\` to specify which rows in the range this applies to.
* **Logical Chunks:** Structure the \`chunks\` array to mirror the logical sections of the pattern as a crafter would read them (e.g., Edge, Lace Panel, Center).
* **Dynamic Calculation Flag:** For repeating rows where an inner part changes predictably (e.g., "knit to marker"), use \`"dynamicChunks": true\`. This tells the application to calculate the variable parts on the fly.

(The full schema and examples from the template are included in the actual prompt logic but omitted here for brevity in the script)
`;

    function updatePrompt() {
        const patternText = patternInput.value.trim();
        if (patternText) {
            const fullPrompt = basePrompt.replace('{{PATTERN_TEXT}}', patternText);
            promptOutput.textContent = fullPrompt;
        } else {
            promptOutput.textContent = 'Select a pattern type and paste text to generate the prompt.';
        }
    }

    patternTypeSelector.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            const type = e.target.dataset.type;
            patternTypeSelector.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            
            if (type === 'image') {
                imageInstructions.classList.remove('hidden');
            } else {
                imageInstructions.classList.add('hidden');
            }
        }
    });

    patternInput.addEventListener('input', updatePrompt);

    copyButton.addEventListener('click', () => {
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(promptOutput.textContent).then(() => {
                const defaultSpan = document.getElementById('copy-default');
                const successSpan = document.getElementById('copy-success');
                defaultSpan.classList.add('hidden');
                successSpan.classList.remove('hidden');
                setTimeout(() => {
                    defaultSpan.classList.remove('hidden');
                    successSpan.classList.add('hidden');
                }, 2000);
            });
        } else {
            const textArea = document.createElement('textarea');
            textArea.value = promptOutput.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('Prompt copied to clipboard!');
        }
    });
    
    const tabButtons = document.querySelectorAll('.tab-button[id^="tab-"]');
    const tabContents = document.querySelectorAll('.tab-content[id^="content-"]');

    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            const tabId = button.id.replace('tab-', '');
            
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            tabContents.forEach(content => {
                if (content.id === `content-${tabId}`) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        });
    });
});
</script>
</body>
</html>

